
--- 
title:  CSRF的攻击与法防御 
tags: []
categories: [] 

---
## CSRF的攻击与法防御

****一、CSRF漏洞原理***** *

CSRF（Cross-Site Request Forgery，跨站点伪造请求）是一种网络攻击方式，该攻击可以在受害者毫不知情的情况下以受害者名义伪造请求发送给受攻击站点，从而在未授权的情况下执行在权限保护之下的操作，具有很大的危害性。

具体来讲，可以这样理解CSRF攻击：攻击者盗用了你的身份，以你的名义发送恶意请求，对服务器来说这个请求是完全合法的，但是却完成了攻击者所期望的一个操作，比如以你的名义发送邮件、发消息，盗取你的账号，添加系统管理员，甚至于购买商品、虚拟货币转账等。

<img src="https://img-blog.csdnimg.cn/img_convert/256af99b7c132ebdd6602e1a215046c0.png" alt="图片">

****二、CSRF场景****

修改个人数据（横向越权）

添加用户（纵向越权）等

****三、CSRF常出现业务****

CSRF一般用于操作用户的资源，或者使用用户的权限进行操作，或者窃取用户的相关信息。

可以这么理解CSRF攻击：攻击者盗用了你的身份，以你的名义发送恶意请求。

****四、CSRF比XSS更具危险性？****

CSRF不一定比XSS更有危险性。CSRF能完成的事，XSS更能够完成；XSS能完成的事，CSRF不一定能做到。

****五、CSRF的最佳利用方式****

CSRF给电商用户新增默认收货地址、发微博、添加管理员等到，所有的敏感操作都可以是CSRF的攻击目标，也就是说，所有敏感操作都需要进行CSRF的防护
<li><li>
****六、CSRF的防护方案****

CSRF的防护，主要是referer限制，token、或验证码。甚至非常敏感的操作更应该要使用短信验证这种方式，另外，防护手段可以加上一条：多使用post方式获取参数，进行敏感功能。如果你的请求仅仅是ajax请求，那么还有些别的防护手段。比如校验X-Requested-With头。跨域的form表单提交是伪造不了这个ajax请求头。甚至你可以在ajax中

安全需要打组合拳，各个部分都需要兼顾到，比如严格的日志系统，这个在企业防护CSRF中，算是事后防护了，能甄别一定的CSRF攻击。

****七、CSRF漏洞自动化探测****

**1、手动探测原理**

手动探测原理在于探测web应用程序具有防止CSRF的措施。

<img src="https://img-blog.csdnimg.cn/img_convert/18c5001da4966711e56bd5614586016f.png" alt="图片">

如果Web应用程序的HTTP请求中没有对应的预防措施，那么很大程度上就确定存在CSRF漏洞。

**2、自动化探测工具介绍**

CSRFTester是一款CSRF漏洞的测试工具。

CSRFTester工具的测试原理大概是这样的，使用代理抓取我们在浏览器中访问过的所有的连接以及所有的表单等信息，通过在CSRFTester中修改相应的表单等信息，重新提交，相当于一次伪造客户端请求，如果修测试的请求成功被网站服务器接受，则说明存在CSRF漏洞，当然此款工具也可以被用来进行CSRF攻击。
- 设置浏览器代理：127.0.0.1:8008- 登录Web应用程序，提交表单，在CSRF工具中修改表单内容，查看是否更改，如果更改表面存在CSRF漏洞。- 生产POC代码。
<img src="https://img-blog.csdnimg.cn/img_convert/e12f4beba8dd70839e244f64a01a4b0a.png" alt="图片">

表面存在CSRF漏洞。
- 生产POC代码。
[外链图片转存中…(img-78B3EuwM-1705999066408)]

<img src="https://img-blog.csdnimg.cn/img_convert/61e4eb033fd964f13c8588f337d7836f.png" alt="图片">

## 学习资料分享

当然，**只给予计划不给予学习资料的行为无异于耍流氓**，### 如果你对网络安全入门感兴趣，那么你点击这里**👉**

**如果你对网络安全感兴趣，学习资源免费分享，保证100%免费！！！（嘿客入门教程）**

**👉网安（嘿客）全套学习视频👈**

我们在看视频学习的时候，不能光动眼动脑不动手，比较科学的学习方法是在理解之后运用它们，这时候练手项目就很适合了。

#### 

#### <img src="https://img-blog.csdnimg.cn/img_convert/d1c617b78ee48eda7601e5b803e69276.png" alt="img">

#### **👉网安（嘿客红蓝对抗）所有方向的学习路线****👈**

对于从来没有接触过网络安全的同学，我们帮你准备了详细的学习成长路线图。可以说是最科学最系统的学习路线，大家跟着这个大的方向学习准没问题。

#### <img src="https://img-blog.csdnimg.cn/img_convert/de55dfd737dae0cf88e416d0454b17a8.png" alt="img">

#### 学习资料工具包

压箱底的好资料，全面地介绍网络安全的基础理论，包括逆向、八层网络防御、汇编语言、白帽子web安全、密码学、网络安全协议等，将基础理论和主流工具的应用实践紧密结合，有利于读者理解各种主流工具背后的实现机制。

<img src="https://img-blog.csdnimg.cn/9609a53465cf4253b492a5185896fa71.png" alt="在这里插入图片描述">

**面试题资料**

独家渠道收集京东、360、天融信等公司测试题！进大厂指日可待！ <img src="https://img-blog.csdnimg.cn/f5f267c281c543fb9cc9af53b9003a37.png" alt="在这里插入图片描述">

#### **👉<strong><strong>嘿客必备开发工具**</strong>👈</strong>

工欲善其事必先利其器。学习**嘿**客常用的开发软件都在这里了，给大家节省了很多时间。

#### 这份完整版的网络安全（**嘿**客）全套学习资料已经上传至CSDN官方，朋友们如果需要点击下方链接**也可扫描下方微信二v码获取网络工程师全套资料**【保证100%免费】

#### <img src="https://img-blog.csdnimg.cn/img_convert/16c400294b6fda8f01400f24f1f12b0c.png" alt="在这里插入图片描述">

#### 如果你对网络安全入门感兴趣，那么你点击这里**👉**
