
--- 
title:  ä¸‡å­—é•¿æ–‡ - Python æ—¥å¿—è®°å½•å™¨logging ç™¾ç§‘å…¨ä¹¦ - é«˜çº§é…ç½®ä¹‹ æ—¥å¿—æ–‡ä»¶é…ç½® 
tags: []
categories: [] 

---
<img src="https://img-blog.csdnimg.cn/028756c9e83645fb92b1b441a14653f1.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">

## ä¸‡å­—é•¿æ–‡ - Python æ—¥å¿—è®°å½•å™¨logging ç™¾ç§‘å…¨ä¹¦ - é«˜çº§é…ç½®ä¹‹ æ—¥å¿—æ–‡ä»¶é…ç½®

## å‰è¨€

åœ¨ `Python` çš„`logging`æ¨¡å—ä¸­ï¼Œå®ƒä¸ä»…æä¾›äº†åŸºç¡€çš„æ—¥å¿—åŠŸèƒ½ï¼Œè¿˜æ‹¥æœ‰ä¸€ç³»åˆ—é«˜çº§é…ç½®é€‰é¡¹æ¥æ»¡è¶³å¤æ‚åº”ç”¨çš„æ—¥å¿—ç®¡ç†éœ€æ±‚ã€‚

è¯´åˆ°`logging` æ¨¡å—çš„é«˜çº§é…ç½®ï¼Œå¿…é¡»æåŠ`æ—¥å¿—åˆ†å±‚`ã€`logging.configé…ç½®`ã€`æ—¥å¿—å¼‚æ­¥æ“ä½œ`ç­‰å…³é”®åŠŸèƒ½ã€‚å®ƒä»¬æ¯ä¸€é¡¹éƒ½ä¸ºå¼€å‘è€…æä¾›äº†å¼ºå¤§çš„è°ƒè¯•å’Œç›‘æ§ç¯å¢ƒï¼Œå¯¹äºæ„å»ºå¯ç»´æŠ¤å’Œé«˜æ•ˆçš„æ—¥å¿—ç³»ç»Ÿè‡³å…³é‡è¦ã€‚

åœ¨æ¥ä¸‹æ¥çš„ä¸‰ç¯‡`loggingé«˜çº§é…ç½®` æ–‡ç« ä¸­ï¼Œæˆ‘å°†ä¸ºè¯»è€…æœ‹å‹ä»¬ä»‹ç» `Python` çš„ `logging` æ¨¡å—ä¸­çš„ä¸‰ä¸ªé«˜çº§é…ç½®çš„å…·ä½“åº”ç”¨ï¼š`æ—¥å¿—åˆ†å±‚`ã€`logging.config` ä»¥åŠ `æ—¥å¿—å¼‚æ­¥æ“ä½œ`ï¼Œæ¢è®¨å®ƒä»¬å¦‚ä½•ä¼˜åŒ–æ—¥å¿—å¤„ç†æµç¨‹ï¼Œå¹¶æå‡åº”ç”¨çš„æ•´ä½“æ€§èƒ½ã€‚

æœ¬æ–‡å°†èšç„¦äº `logging` æ¨¡å—ä¸­çš„`æ—¥å¿—æ–‡ä»¶é…ç½®`æ¦‚å¿µï¼Œæ¢è®¨å¦‚ä½•é€šè¿‡é…ç½®æ–‡ä»¶çµæ´»å®šä¹‰å’Œè°ƒæ•´æ—¥å¿—è®°å½•å™¨çš„è¡Œä¸ºã€‚æˆ‘ä»¬å°†è¯¦ç»†è§£æå¦‚ä½•åˆ©ç”¨é…ç½®æ–‡ä»¶æ¥è®¾ç½®æ—¥å¿—çº§åˆ«ã€æ ¼å¼ã€è¾“å‡ºç›®çš„åœ°ç­‰ï¼Œä»¥æ„å»ºä¸€ä¸ªæ—¢çµæ´»åˆå¯æ‰©å±•çš„æ—¥å¿—ç³»ç»Ÿã€‚

## çŸ¥è¯†ç‚¹ğŸ“–ğŸ“–

|æ¨¡å—|é‡Šä¹‰
|------
||`Python` çš„æ—¥å¿—è®°å½•å·¥å…·ï¼Œæ ‡å‡†åº“
|`logging.config`|æ—¥å¿—æ–‡ä»¶é…ç½®å‡½æ•°
||

**å¯¼å…¥æ¨¡å—**

```
import logging
import logging.config


```

**æ–‡ç« è„‰ç»œï¼š**
- <font color="bluegreenred">**ç‚¹å‡»ç›´è¾¾ï¼š**</font>- <font color="bluegreenred">**ç‚¹å‡»ç›´è¾¾ï¼š**</font>- <font color="bluegreenred">**ç‚¹å‡»ç›´è¾¾ï¼š**</font>- <font color="bluegreenred">**ç‚¹å‡»ç›´è¾¾ï¼š**</font>- <font color="bluegreenred">**ç‚¹å‡»ç›´è¾¾ï¼š**</font>
## ç†è§£æ–‡ä»¶é…ç½® logging.config

>  
 `logging.config` ä¸“é—¨ç”¨äºé…ç½®æ—¥å¿—ç³»ç»Ÿã€‚å®ƒæä¾›äº†çµæ´»çš„é…ç½®æ–¹å¼ï¼Œæ”¯æŒå¤šç§é…ç½®æ–¹æ³•ï¼ŒåŒ…æ‹¬åŸºäºæ–‡ä»¶çš„é…ç½®ï¼ˆå¦‚ `INI` ã€`JSON` å’Œ `YAML`æ–‡ä»¶ç­‰ï¼‰ã€‚ 


### ä½œç”¨å’Œåº”ç”¨åœºæ™¯

`logging.config` æ¨¡å—çš„ä¸»è¦ä½œç”¨æ˜¯æä¾›ä¸€ç§æ ‡å‡†åŒ–ã€çµæ´»çš„æ–¹æ³•æ¥é…ç½® `Python` åº”ç”¨ç¨‹åºä¸­çš„æ—¥å¿—è®°å½•ã€‚é€šè¿‡ä½¿ç”¨è¿™ä¸ªæ¨¡å—ï¼Œå¼€å‘è€…å¯ä»¥è½»æ¾å®šä¹‰æ—¥å¿—çš„çº§åˆ«ã€æ ¼å¼ã€è¾“å‡ºç›®æ ‡ï¼ˆå¦‚æ–‡ä»¶ã€æ§åˆ¶å°ã€ç½‘ç»œæœåŠ¡ç­‰ï¼‰ä»¥åŠå…¶ä»–é«˜çº§åŠŸèƒ½ï¼Œæ¯”å¦‚æ—¥å¿—è½®è½¬å’Œè¿‡æ»¤ã€‚

å®ƒé€‚ç”¨äºå„ç§è§„æ¨¡çš„ `Python` åº”ç”¨ç¨‹åºï¼Œä»å°å‹è„šæœ¬åˆ°å¤§å‹ç³»ç»Ÿã€‚åœ¨å¤æ‚çš„ç³»ç»Ÿä¸­ï¼Œ`logging.config` å¯ä»¥ç«‹å¤§åŠŸï¼Œå› ä¸ºå®ƒå¯ä»¥å¸®åŠ©ç®¡ç†å’Œæ§åˆ¶å¤šä¸ªæ—¥å¿—è®°å½•å™¨å’Œå¤„ç†å™¨ã€‚

ä¸‹é¢æ˜¯`logging.config`ä¸­å¸¸ç”¨çš„æ–¹æ³•åŠå…¶ä½œç”¨ï¼š

|æ–¹æ³•å|ä½œç”¨
|------
|`dictConfig(config_dict)`|ä½¿ç”¨å­—å…¸é…ç½®æ—¥å¿—è®°å½•å™¨ã€‚
|`fileConfig(fname, defaults=None, disable_existing_loggers=True)`|ä»é…ç½®æ–‡ä»¶åŠ è½½æ—¥å¿—é…ç½®ã€‚
|`listen(port=DEFAULT_LOGGING_CONFIG_PORT)`|ç›‘å¬è¿œç¨‹æ—¥å¿—é…ç½®çš„æ›´æ”¹ã€‚
|`stopListening()`|åœæ­¢ç›‘å¬è¿œç¨‹æ—¥å¿—é…ç½®çš„æ›´æ”¹ã€‚

ä¸‹é¢åªä»‹ç»å…³äº `dictConfig` å’Œ `fileConfig`ï¼Œå› ä¸º`listen`ä¸å¸¸ç”¨ã€‚

### âš ï¸âš ï¸æ³¨æ„ç‚¹

>  
 å»ºè®®ä½¿ç”¨`dictConfig`ï¼Œè€Œä¸æ˜¯ `fileConfig`ã€‚ 


å…ˆè¯´ç»“è®ºï¼Œ
- `fileConfig` åœ¨æŸäº›æ–¹é¢ï¼ˆä¸æ”¯æŒ`filters`ï¼Œéœ€è¦é¢å¤–é…ç½®ï¼‰æ˜¾å¾—ä¸å¤Ÿçµæ´»ï¼Œé€‚ç”¨äºç®€å•çš„æ—¥å¿—é…ç½®éœ€æ±‚ã€‚- `dictConfig` æä¾›äº†æ›´é«˜çš„çµæ´»æ€§å’Œæ›´å…¨é¢çš„é…ç½®é€‰é¡¹ï¼Œæ›´é€‚åˆå¤æ‚çš„æ—¥å¿—é…ç½®éœ€æ±‚ã€‚
`logging.config.dictConfig `è¾ƒæ¯” `logging.config.fileConfig` å¯è°“æ˜¯é¥é¥é¢†å…ˆï¼ï¼
- `dictConfig` æ”¯æŒ` JSON` å’Œ `YAML`æ ¼å¼ï¼Œæ”¯æŒæ‰€æœ‰æ—¥å¿—é…ç½®åŠŸèƒ½ï¼Œå¯ä»¥æ›´çµæ´»åœ°è¡¨ç¤ºå¤æ‚çš„é…ç½®ç»“æ„ï¼ŒåŒ…æ‹¬è¿‡æ»¤å™¨ã€å¤šä¸ªå¤„ç†å™¨å’Œè®°å½•å™¨ç­‰ã€‚- `fileConfig` æ”¯æŒ `INI` æ ¼å¼çš„æ–‡ä»¶ï¼Œè¿™ç§æ ¼å¼ç›¸å¯¹ç®€å•ï¼Œåœ¨è¡¨è¾¾èƒ½åŠ›ä¸Šä¸å¦‚ `JSON` æˆ– `YAML` å¼ºã€‚ä¸æ”¯æŒç›´æ¥åœ¨é…ç½®æ–‡ä»¶ä¸­å®šä¹‰è¿‡æ»¤å™¨ï¼Œåªé€‚åˆç®€å•çš„æ—¥å¿—é…ç½®éœ€æ±‚ã€‚
### logging.config.dictConfig

>  
 é…ç½®å­—å…¸ï¼Œæ”¯æŒå­—å…¸ï¼Œ` JSON` å’Œ `YAML`æ ¼å¼ã€‚ 


æ— è®ºä½¿ç”¨å“ªç§æ ¼å¼ï¼Œå®ƒä»¬çš„ä¸»è¦åŒºåˆ«åœ¨äºæ•°æ®æ ¼å¼å’Œå¯è¯»æ€§ã€‚é€‰æ‹©æ›´åŠ ç¬¦åˆè‡ªå·±çš„å¼€å‘ä¹ æƒ¯çš„å³å¯ã€‚

**JSON**:
- æ ¼å¼æ›´ä¸¥æ ¼ï¼ˆä¾‹å¦‚ï¼Œå¿…é¡»ä½¿ç”¨åŒå¼•å·ï¼Œä¸èƒ½æœ‰æ³¨é‡Šï¼‰ã€‚- åœ¨å¤šæ•°ç¼–ç¨‹ç¯å¢ƒä¸­å¹¿æ³›æ”¯æŒã€‚- å¯èƒ½æ›´é€‚åˆé‚£äº›ä¹ æƒ¯äºç¼–ç¨‹å’Œå¤„ç†ç»“æ„åŒ–æ•°æ®çš„ç”¨æˆ·ã€‚
**YAML**:
- å¯è¯»æ€§æ›´å¥½ï¼Œå®¹é”™æ€§æ›´å¥½ï¼ˆä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨æ³¨é‡Šï¼Œå¯¹å¼•å·ä¸æ•æ„Ÿï¼‰ã€‚- é€‚åˆé…ç½®æ–‡ä»¶ï¼Œå› ä¸ºå®ƒæ›´æ˜“äºè¯»å†™ï¼Œç‰¹åˆ«æ˜¯å¯¹äºè¾ƒé•¿æˆ–å¤æ‚çš„é…ç½®ã€‚- éœ€è¦é¢å¤–çš„åº“æ¥è§£æï¼ˆ`Python` ä¸­éœ€è¦å®‰è£… `PyYAML`ï¼‰ã€‚
ä¸‹é¢å°†ä½¿ç”¨ `dict()` å­—å…¸è¿›è¡Œä»‹ç»ï¼ˆå› ä¸ºæ–¹ä¾¿ï¼‰ï¼Œ`JSON` å’Œ`YAML`æ ¼å¼è‡ªè¡Œå­¦ä¹ ~

**æ–¹æ³•ï¼š**

```
logging.config.dictConfig(config)

```

#### åŸºæœ¬ç¤ºä¾‹

>  
 ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ `logging.config.dictConfig` çš„ç®€å•ç¤ºä¾‹ï¼Œè¿™ä¸ªç¤ºä¾‹é…ç½®äº†åŸºæœ¬çš„æ—¥å¿—è®°å½•åŠŸèƒ½ï¼ŒåªåŒ…å«ä¸€ä¸ªå°†æ—¥å¿—ä¿¡æ¯è¾“å‡ºåˆ°æ§åˆ¶å°çš„å¤„ç†å™¨ï¼ˆhandlerï¼‰ 

- å®šä¹‰äº†ä¸€ä¸ªåä¸º `console` çš„å¤„ç†å™¨ï¼Œå®ƒä½¿ç”¨ `logging.StreamHandler` å°†æ—¥å¿—ä¿¡æ¯è¾“å‡ºåˆ°æ§åˆ¶å°ï¼ˆæ ‡å‡†è¾“å‡ºï¼‰ã€‚- è®¾ç½®äº†ä¸€ä¸ªç®€å•çš„æ—¥å¿—æ ¼å¼ï¼ŒåŒ…æ‹¬æ—¶é—´æˆ³ã€æ—¥å¿—çº§åˆ«å’Œæ—¥å¿—æ¶ˆæ¯ã€‚- é…ç½®äº†æ ¹æ—¥å¿—è®°å½•å™¨ï¼Œå°†å…¶æ—¥å¿—çº§åˆ«è®¾ç½®ä¸º `INFO`ï¼Œè¿™æ„å‘³ç€åªæœ‰ `INFO` çº§åˆ«åŠä»¥ä¸Šï¼ˆå¦‚ `WARNING`, `ERROR`, `CRITICAL`ï¼‰çš„æ—¥å¿—ä¼šè¢«å¤„ç†ã€‚- ä½¿ç”¨ `dictConfig` å‡½æ•°åº”ç”¨è¿™ä¸ªé…ç½®ã€‚
**ç¤ºä¾‹ä»£ç **

```
import logging
from logging.config import dictConfig

# æ—¥å¿—é…ç½®å­—å…¸
log_config = {<!-- -->
    'version': 1,
    'handlers': {<!-- -->
        'console': {<!-- -->  # å®šä¹‰ä¸€ä¸ªåä¸º "console" çš„å¤„ç†å™¨
            'class': 'logging.StreamHandler',
            'level': 'INFO',
            'formatter': 'simple',
            'stream': 'ext://sys.stdout'  # ä½¿ç”¨æ ‡å‡†è¾“å‡º
        }
    },
    'formatters': {<!-- -->
        'simple': {<!-- -->  # å®šä¹‰ä¸€ä¸ªç®€å•çš„æ ¼å¼å™¨
            'format': '%(asctime)s - %(levelname)s - %(message)s',
            'datefmt': '%Y-%m-%d %H:%M:%S'
        }
    },
    'root': {<!-- -->  # é…ç½®æ ¹æ—¥å¿—è®°å½•å™¨
        'level': 'INFO',
        'handlers': ['console']
    }
}

# åº”ç”¨æ—¥å¿—é…ç½®
dictConfig(log_config)

# è·å–æ—¥å¿—è®°å½•å™¨
logger = logging.getLogger()

# è®°å½•ä¸€äº›æ—¥å¿—
logger.info("è¿™æ˜¯ä¸€ä¸ªä¿¡æ¯çº§åˆ«çš„æ—¥å¿—")
logger.warning("è¿™æ˜¯ä¸€ä¸ªè­¦å‘Šçº§åˆ«çš„æ—¥å¿—")


```

#### å‚æ•°è¯¦è§£

>  
 ä¸‹é¢çš„æ¯ä¸€ä¸ªå‚æ•°éƒ½ä¸æ˜¯ç‹¬ç«‹çš„ï¼Œæœ€ç»ˆå®ƒä»¬ç»“åˆèµ·æ¥ï¼Œä¾¿æ˜¯ä¸€ä»½å®Œæ•´çš„`logging.config.dictConfig` çš„æ—¥å¿—æ–‡ä»¶é…ç½®ã€‚ 


ä»¥ä¸‹æ˜¯ `logging.config.dictConfig` æ–¹æ³•ä¸­å„ä¸ªå‚æ•°çš„æ•´ç†ï¼š

|å‚æ•°å|ç±»å‹|å¿…éœ€|æè¿°
|------
|`version`|int|å¿…éœ€|å”¯ä¸€ä¸€ä¸ªå¿…é€‰é¡¹ï¼Œå¿…é¡»è®¾ç½®ä¸º 1ï¼Œè¡¨ç¤ºé…ç½®å­—å…¸çš„ç‰ˆæœ¬ã€‚
|`formatters`|dict|å¯é€‰|å®šä¹‰æ—¥å¿—çš„æ ¼å¼ï¼Œé”®æ˜¯æ ¼å¼å™¨çš„åç§°ï¼Œå€¼æ˜¯æ ¼å¼å™¨çš„é…ç½®å­—å…¸ã€‚
|`filters`|dict|å¯é€‰|å®šä¹‰è¿‡æ»¤å™¨ï¼Œç”¨äºè¿‡æ»¤æ—¥å¿—è®°å½•ã€‚é”®æ˜¯è¿‡æ»¤å™¨çš„åç§°ï¼Œå€¼æ˜¯è¿‡æ»¤å™¨çš„é…ç½®å­—å…¸ã€‚
|`handlers`|dict|å¯é€‰|å®šä¹‰å¤„ç†ç¨‹åºï¼Œå†³å®šæ—¥å¿—å¦‚ä½•è¾“å‡ºã€‚é”®æ˜¯å¤„ç†ç¨‹åºçš„åç§°ï¼Œå€¼æ˜¯å¤„ç†ç¨‹åºçš„é…ç½®å­—å…¸ã€‚
|`loggers`|dict|å¯é€‰|å®šä¹‰è®°å½•å™¨ï¼Œç”¨äºç”Ÿæˆæ—¥å¿—è®°å½•ã€‚é”®æ˜¯è®°å½•å™¨çš„åç§°ï¼Œå€¼æ˜¯è®°å½•å™¨çš„é…ç½®å­—å…¸ã€‚
|`root`|dict|å¯é€‰|å®šä¹‰æ ¹è®°å½•å™¨çš„é…ç½®ï¼ŒåŒ…å«æ—¥å¿—çº§åˆ«å’Œå¤„ç†ç¨‹åºåˆ—è¡¨ã€‚
|`incremental`|bool|å¯é€‰|é»˜è®¤`False`ï¼Œç”¨äºæŒ‡å®šæ˜¯å¦åº”è¯¥å¢é‡åœ°åº”ç”¨é…ç½®ã€‚
|`disable_existing_loggers`|bool|å¯é€‰|é»˜è®¤`True`ï¼Œç”¨äºæŒ‡å®šæ˜¯å¦ç¦ç”¨æ‰€æœ‰å·²å­˜åœ¨çš„è®°å½•å™¨ã€‚

##### **1. version**

>  
 åº”è®¾ä¸ºä»£è¡¨æ¶æ„ç‰ˆæœ¬çš„æ•´æ•°å€¼ã€‚ ç›®å‰å”¯ä¸€æœ‰æ•ˆçš„å€¼æ˜¯ 1ã€‚ 

- å”¯ä¸€ä¸€ä¸ªå¿…é€‰é¡¹ï¼Œå¿…é¡»è®¾ç½®ä¸º 1ï¼Œè¡¨ç¤ºé…ç½®å­—å…¸çš„ç‰ˆæœ¬ã€‚
```
logg_config = {<!-- -->
    'version': 1
}

```

##### **2. formatters**

>  
 å¯¹åº”çš„å€¼æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œå…¶ä¸­æ¯ä¸ªé”®æ˜¯ä¸€ä¸ªæ ¼å¼å™¨ ID è€Œæ¯ä¸ªå€¼åˆ™æ˜¯ä¸€ä¸ªæè¿°å¦‚ä½•é…ç½®ç›¸åº” `Formatter` å®ä¾‹çš„å­—å…¸ 


ä»¥ä¸‹æ˜¯ `formatters` å­—å…¸ä¸­å…¨éƒ¨çš„å‚æ•°ï¼š
- **format**ï¼š å®šä¹‰æ—¥å¿—æ¶ˆæ¯çš„æ ¼å¼ã€‚è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¯ä»¥åŒ…å«å„ç§æ—¥å¿—è®°å½•å±æ€§çš„å ä½ç¬¦ï¼Œå¦‚ `%(levelname)s`, `%(message)s`, `%(asctime)s` ç­‰ã€‚- **datefmt**ï¼š å®šä¹‰æ—¥æœŸå’Œæ—¶é—´çš„æ ¼å¼ã€‚è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨äºæ ¼å¼åŒ–æ—¥å¿—è®°å½•ä¸­çš„æ—¶é—´æˆ³ï¼Œä¾‹å¦‚ `%Y-%m-%d %H:%M:%S`ã€‚- **style**ï¼šæŒ‡å®š`format`å­—ç¬¦ä¸²çš„æ ¼å¼åŒ–é£æ ¼ã€‚Pythonæ ‡å‡†åº“çš„æ—¥å¿—æ¨¡å—æ”¯æŒä¸‰ç§é£æ ¼ï¼šâ€˜%â€™ï¼ˆé»˜è®¤ï¼‰ã€â€˜{â€˜å’Œâ€™$â€™ã€‚- **validate**ï¼šå¸ƒå°”å€¼ï¼ŒæŒ‡å®šæ˜¯å¦å¯¹ format å­—ç¬¦ä¸²è¿›è¡ŒéªŒè¯ã€‚é»˜è®¤ä¸º `True`ã€‚- **class**ï¼š æŒ‡å®šè‡ªå®šä¹‰çš„æ ¼å¼å™¨ç±»ã€‚è¿™æ˜¯å¯é€‰çš„ï¼Œä»…å½“éœ€è¦ä½¿ç”¨ä¸æ˜¯æ ‡å‡†çš„`logging.Formatter`çš„æ ¼å¼å™¨æ—¶ä½¿ç”¨ã€‚
**ç¤ºä¾‹ä»£ç ï¼š**
- åŒ…å«ä¸¤ä¸ªæ ¼å¼å™¨ï¼Œ`simple` å’Œ `complex`ï¼Œåˆ†åˆ«æŒ‡å®šäº† `format` ã€`style` ç­‰
```
log_config = {<!-- -->
    'version': 1,
    'formatters': {<!-- -->
        'simple': {<!-- -->
            'format': '%(levelname)s - %(asctime)s - %(name)s - %(message)s',
            'style ': '%',  # é»˜è®¤å€¼
            'datefmt': '%Y-%m-%d %H:%M:%S',
        },
        'complex': {<!-- -->
            'format': '{levelname} - {asctime} - {name} - {message}',
            'style': '{'
        }
    }
}

```

##### **3. filters**

>  
 è¿™é‡Œå¯ä»¥ç»“åˆè¿™ç¯‡æ–‡ç« é£Ÿç”¨ï¼š 


å¯¹åº”çš„å€¼å°†æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œå…¶ä¸­æ¯ä¸ªé”®æ˜¯ä¸€ä¸ªè¿‡æ»¤å™¨ ID è€Œæ¯ä¸ªå€¼åˆ™æ˜¯ä¸€ä¸ªæè¿°å¦‚ä½•é…ç½®ç›¸åº” Filter å®ä¾‹çš„å­—å…¸ã€‚

é…ç½®æ—¥å¿—è®°å½•çš„è¿‡æ»¤å™¨ï¼Œä¸€èˆ¬è¿‡æ»¤å™¨éœ€è¦ç»‘å®šåˆ°å¤„ç†å™¨ä¸­ï¼Œæ‰€ä»¥éœ€è¦ç»“åˆä¸‹é¢çš„`handlees` ä½¿ç”¨ã€‚
- **name**ï¼šå­—ç¬¦ä¸²ï¼Œè¿‡æ»¤å™¨åç§°- **()**ï¼šå­—ç¬¦ä¸²ï¼Œè¿‡æ»¤å™¨çš„ç±»å‘½ï¼Œç”¨äºæŒ‡å®šæ—¥å¿—ç³»ç»Ÿä½¿ç”¨å“ªä¸ªè¿‡æ»¤å™¨ï¼Œå¦‚`logging.Filter`ï¼Œä¹Ÿå¯ä»¥æ˜¯è‡ªå®šä¹‰è¿‡æ»¤å™¨ç±»çš„è·¯å¾„ã€‚- **param**ï¼šå¯é€‰ï¼Œå¦‚æœè¿‡æ»¤ç±»æœ‰éœ€è¦ï¼Œåˆ™å¯ä¼ é€’ã€‚
**æ— paramå‚æ•°ï¼š**
- è‡ªå®šä¹‰è¿‡æ»¤å™¨`CommonFilter`ï¼Œ`console_filter`æŒ‡å®šçš„è¿‡æ»¤å™¨ç±»è·¯å¾„ä¸º `CommonFilter`ï¼ˆ`__main__`éœ€è¦æ›´æ”¹ä¸ºè‡ªå®šä¹‰è¿‡æ»¤å™¨çš„è·¯å¾„
```
import logging


# è‡ªå®šä¹‰è¿‡æ»¤å™¨ - æ§åˆ¶å°ä½¿ç”¨
class CommonFilter(logging.Filter):
    def filter(self, record):
        # è¿‡æ»¤æ‰åŒ…å«æ•æ„Ÿä¿¡æ¯çš„æ—¥å¿—
        return "æ•æ„Ÿä¿¡æ¯" not in record.getMessage()

    
log_config = {<!-- -->
    'version': 1,
    'filters': {<!-- -->
        'console_filter': {<!-- -->
            '()': '__main__.CommonFilter'
        }
    }
}

```

**æœ‰paramå‚æ•°ï¼š**
- æºå¸¦å‚æ•°
```
import logging


# è‡ªå®šä¹‰è¿‡æ»¤å™¨ - æ§åˆ¶å°ä½¿ç”¨
class CommonFilter(logging.Filter):
    def __init__(self, param1=None, param2=None):
        super().__init__()
        self.param1 = param1
        self.param2 = param2

    def filter(self, record):
        # è¿‡æ»¤æ‰åŒ…å«æ•æ„Ÿä¿¡æ¯çš„æ—¥å¿—
        return "æ•æ„Ÿä¿¡æ¯" not in record.getMessage()


log_config = {<!-- -->
    'version': 1,
    'filters': {<!-- -->
        'console_filter': {<!-- -->
            '()': '__main__.CommonFilter',
            'param1': "value1",
            'param2': "value2"
        }
    }
}


```

##### **4. handlers**

å¯¹åº”çš„å€¼å°†æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œå…¶ä¸­æ¯ä¸ªé”®æ˜¯ä¸€ä¸ªå¤„ç†å™¨ ID è€Œæ¯ä¸ªå€¼åˆ™æ˜¯ä¸€ä¸ªæè¿°å¦‚ä½•é…ç½®ç›¸åº” Handler å®ä¾‹çš„å­—å…¸ã€‚

|å‚æ•°å|ç±»å‹|å¿…éœ€|æè¿°
|------
|`class`|string|å¿…éœ€|å¤„ç†å™¨çš„ç±»åï¼Œä¾‹å¦‚ `logging.StreamHandler` æˆ– `logging.handlers.FileHandler`
|`level`|string|å¯é€‰|å¤„ç†å™¨çš„æ—¥å¿—çº§åˆ«ï¼Œä¾‹å¦‚ â€˜DEBUGâ€™ã€â€˜INFOâ€™ã€â€˜WARNINGâ€™ã€â€˜ERRORâ€™ æˆ– â€˜CRITICALâ€™ã€‚é»˜è®¤ä¸º â€˜NOTSETâ€™
|`formatter`|string|å¯é€‰|å¤„ç†å™¨ä½¿ç”¨çš„æ ¼å¼åŒ–å™¨çš„åç§°ï¼Œé€šå¸¸ä¸ formatters å­—å…¸ä¸­çš„ä¸€ä¸ªæ ¼å¼åŒ–å™¨åç§°å¯¹åº”
|`filename`|string|å¯é€‰|åªæœ‰åœ¨å¤„ç†å™¨ç±»å‹ä¸º `FileHandler` æ—¶æ‰é€‚ç”¨ã€‚æŒ‡å®šå†™å…¥æ—¥å¿—çš„æ–‡ä»¶å
|`mode`|string|å¯é€‰|åªæœ‰åœ¨å¤„ç†å™¨ç±»å‹ä¸º `FileHandler` æ—¶æ‰é€‚ç”¨ã€‚æŒ‡å®šæ–‡ä»¶çš„æ‰“å¼€æ¨¡å¼ï¼Œé»˜è®¤ä¸º `a`
|`encoding`|string|å¯é€‰|åªæœ‰åœ¨å¤„ç†å™¨ç±»å‹ä¸º `FileHandler` æ—¶æ‰é€‚ç”¨ã€‚æŒ‡å®šæ–‡ä»¶çš„ç¼–ç ï¼Œé»˜è®¤ä¸º None
|`delay`|bool|å¯é€‰|åªæœ‰åœ¨å¤„ç†å™¨ç±»å‹ä¸º `FileHandler` æ—¶æ‰é€‚ç”¨ã€‚æŒ‡å®šæ–‡ä»¶åˆ›å»ºçš„æ—¶æœº
|`stream`|string|å¯é€‰|åªæœ‰åœ¨å¤„ç†å™¨ç±»å‹ä¸º `StreamHandler` æ—¶æ‰é€‚ç”¨ã€‚æŒ‡å®šè¾“å‡ºæµï¼Œä¾‹å¦‚ `ext://sys.stdout`ï¼Œé»˜è®¤ä¸º`sys.stderr`
|`filters`|list|å¯é€‰|æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨çš„åç§°åˆ—è¡¨ï¼Œç”¨äºè¿‡æ»¤è¦å‘é€åˆ°å¤„ç†å™¨çš„æ—¥å¿—æ¶ˆæ¯

**ä»£ç **

>  
 ä¸€èˆ¬æ¥è¯´ï¼Œéœ€è¦å°†æ—¥å¿—å¤„ç†å™¨ï¼ˆ`Handler`ï¼‰æ·»åŠ åˆ°æ—¥å¿—è®°å½•å™¨ï¼ˆ`Logger`ï¼‰ä¸­æ‰èƒ½ä½¿ç”¨ã€‚ 

- åŒ…å«ä¸¤ä¸ªå¤„ç†å™¨`console` å’Œ `file`ï¼Œåˆ†åˆ«è®¾ç½®äº†`class`ï¼Œ `formatter`ï¼Œ `level`,ç­‰ï¼Œæ³¨æ„ `FileHandler` å’Œ `StreamHandler` æ‰€æ¥å—çš„å‚æ•°æœ‰æ‰€ä¸åŒï¼
```
log_config = {<!-- -->
    'version': 1,
    'handlers': {<!-- -->
        'console': {<!-- -->
            'class': 'logging.StreamHandler',
            'formatter': 'simple',
            'level': 'DEBUG',
            'filters': ['common_filter'],
            'stream': 'ext://sys.stdin',
        },
        'file': {<!-- -->
            'class': 'logging.FileHandler',
            'formatter': 'complex',
            'level': 'DEBUG',
            'filters': ['common_filter'],
            'filename': 'app.log',
            'mode': 'a',
            'encoding': 'utf-8',
        }
    }
}

```

##### 5. loggers

å…¶ä¸­æ¯ä¸ªé”®æ˜¯ä¸€ä¸ªæ—¥å¿—è®°å½•å™¨åç§°ï¼Œè€Œæ¯ä¸ªå€¼åˆ™æ˜¯ä¸€ä¸ªæè¿°å¦‚ä½•é…ç½®ç›¸åº” `Logger `å®ä¾‹çš„å­—å…¸ã€‚æ¯ä¸ªæ—¥å¿—è®°å½•å™¨å¯ä»¥æ¥å—ä»¥ä¸‹å‚æ•°ï¼š
- `level` (å¯é€‰)ã€‚å­—ç¬¦ä¸²ï¼Œæ—¥å¿—è®°å½•å™¨çš„çº§åˆ«ã€‚- `propagate` (å¯é€‰)ã€‚ å¸ƒå°”å€¼ï¼Œæ—¥å¿—è®°å½•å™¨çš„ä¼ æ’­è®¾ç½®ã€‚- `filters` (å¯é€‰)ã€‚ ç”±æ—¥å¿—è®°å½•å™¨å¯¹åº”è¿‡æ»¤å™¨çš„ ID ç»„æˆçš„åˆ—è¡¨ã€‚- `handlers` (å¯é€‰)ã€‚ ç”±æ—¥å¿—è®°å½•å™¨å¯¹åº”å¤„ç†å™¨çš„ ID ç»„æˆçš„åˆ—è¡¨ã€‚
**ä»£ç **
- é…ç½®è¿™é‡Œå°±ä¸è§£é‡Šäº†ï¼Œåœ¨å‰çš„æ–‡ç« éƒ½æœ‰ä»‹ç»~
```
log_config = {<!-- -->
    'version': 1,
    'loggers': {<!-- -->
        'common_logger': {<!-- -->
            'level': 'DEBUG',
            'filters': ['common_filter'],
            'handlers': ['console'],
        },
        'common_logger.file': {<!-- -->
            'level': 'WARNING',
            'propagate': False,
            'filters': ['common_filter'],
            'handlers': ['console', 'file'],
        }
    }
}


```

##### 6. root

æ ¹æ—¥å¿—è®°å½•å™¨å¯¹åº”çš„é…ç½®ã€‚ é…ç½®çš„å¤„ç†æ–¹å¼å°†ä¸æ‰€æœ‰æ—¥å¿—è®°å½•å™¨ä¸€è‡´ï¼Œé™¤äº† `propagate` è®¾ç½®å°†ä¸å¯ç”¨ä¹‹å¤–ã€‚

ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸éœ€è¦æ˜¾å¼è®¾ç½®æ ¹æ—¥å¿—è®°å½•å™¨ï¼ˆ`root logger`ï¼‰ï¼Œæˆ‘ä»¬åªéœ€è¦è®¾ç½®è‡ªå®šä¹‰çš„å­è®°å½•å™¨`Logger`å³å¯ã€‚

å¦‚æœæˆ‘ä»¬çš„åº”ç”¨å¯èƒ½ä¼šä½¿ç”¨é»˜è®¤çš„æ—¥å¿—è®°å½•å™¨ï¼ˆå³ç›´æ¥é€šè¿‡ `logging.getLogger()` è·å–çš„è®°å½•å™¨ï¼‰ï¼Œé‚£ä¹ˆé…ç½®æ ¹æ—¥å¿—è®°å½•å™¨æ˜¯æœ‰æ„ä¹‰çš„ï¼Œå› ä¸ºå®ƒå®šä¹‰äº†è¿™äº›è®°å½•å™¨çš„é»˜è®¤è¡Œä¸ºã€‚æ ¹è®°å½•å™¨çš„ç›®çš„æ˜¯æä¾›ä¸€ä¸ªå…¨å±€çš„ã€åŸºæœ¬çš„æ—¥å¿—é…ç½®ï¼Œä¸ºäº†ä¿æŒç®€å•å’Œæ˜ç¡®ï¼Œé€šå¸¸ä¸ä¼šæ¶‰åŠè¿‡äºå¤æ‚çš„å‚æ•°è®¾ç½®ã€‚

ç½®æ ¹æ—¥å¿—è®°å½•å™¨çš„ `root` éƒ¨åˆ†åŒ…å«ä»¥ä¸‹å‚æ•°ï¼š
1.  `level` (å¯é€‰)ï¼šè®¾ç½®æ ¹æ—¥å¿—è®°å½•å™¨çš„æ—¥å¿—çº§åˆ«ã€‚ 1.  `handlers`ï¼ˆå¯é€‰ï¼‰ï¼šæŒ‡å®šä¸€ä¸ªå¤„ç†å™¨åˆ—è¡¨ï¼Œè¿™äº›å¤„ç†å™¨ä¼šè¢«é™„åŠ åˆ°æ ¹æ—¥å¿—è®°å½•å™¨ã€‚è¿™äº›å¤„ç†å™¨æ§åˆ¶æ—¥å¿—ä¿¡æ¯çš„è¾“å‡ºæ–¹å¼å’Œä½ç½®ã€‚ 1.  `propagate` (å¯é€‰)ï¼šä¸å¸¸ç”¨äº `root`ï¼Œ å¯¹äºéæ ¹æ—¥å¿—è®°å½•å™¨ï¼Œè¿™ä¸ªå¸ƒå°”å€¼æŒ‡å®šæ—¥å¿—ä¿¡æ¯æ˜¯å¦å‘ä¸Šä¼ æ’­åˆ°çˆ¶è®°å½•å™¨ã€‚ä½†å¯¹äºæ ¹è®°å½•å™¨æœ¬èº«ï¼Œè¿™ä¸ªè®¾ç½®é€šå¸¸ä¸é€‚ç”¨æˆ–å¿½ç•¥ï¼Œå› ä¸ºæ ¹è®°å½•å™¨æ˜¯å±‚çº§çš„é¡¶ç«¯ã€‚ 
**ç¤ºä¾‹ä»£ç **
- æŒ‡å®šè·Ÿæ—¥å¿—è®°å½•å™¨çš„`level`ï¼Œ`handlers`ï¼Œ`filters`ç­‰
```
log_config = {<!-- -->
    'version': 1,
    'root': {<!-- -->
        'level': 'DEBUG',
        'handlers': ['console', 'file'],
        'filters': ['common_filter']
    }
}

```

##### 7. incremental

>  
 é…ç½®æ˜¯å¦è¦è¢«è§£è¯»ä¸ºåœ¨ç°æœ‰é…ç½®ä¸Šæ–°å¢ã€‚ è¯¥å€¼é»˜è®¤ä¸º `False`. 

-  å½“ `incremental=True` æ—¶ï¼Œè¿™æ„å‘³ç€æ­£åœ¨è¿›è¡Œå¢é‡æ›´æ–°ã€‚åªæœ‰åœ¨é…ç½®å­—å…¸ä¸­æ˜¾å¼ä¿®æ”¹çš„éƒ¨åˆ†ä¼šè¢«æ›´æ–°ï¼Œè€Œå…¶ä»–çš„é…ç½®å°†ä¿æŒä¸å˜ï¼› -  å½“ä¸ä½¿ç”¨ `incremental=True`ï¼Œå¹¶ä¸”æä¾›äº†ä¸€ä¸ªæ–°çš„é…ç½®å­—å…¸ç»™ `dictConfig`ï¼Œé‚£ä¹ˆæ•´ä¸ªæ—¥å¿—é…ç½®å°†è¢«è¿™ä¸ªæ–°çš„é…ç½®å­—å…¸æ›¿æ¢ï¼ˆè¢«è¦†ç›–ï¼‰ã€‚ 
ä½¿ç”¨ `incremental=True` çš„ä¸»è¦ä½œç”¨æ˜¯å…è®¸å¯¹æ—¥å¿—é…ç½®è¿›è¡Œéƒ¨åˆ†æ›´æ–°ï¼Œï¼ï¼ï¼å€¼å¾—æ³¨æ„çš„æ˜¯
- ç³»ç»Ÿå°†å®Œå…¨å¿½ç•¥ä»»ä½• `formatters` å’Œ `filters` æ¡ç›®ï¼Œå¹¶ä»…ä¼šå¤„ç† `handlers` æ¡ç›®ä¸­çš„ `level` è®¾ç½®ï¼Œä»¥åŠ `loggers` å’Œ `root` æ¡ç›®ä¸­çš„ `level` å’Œ `propagate` è®¾ç½®ã€‚
###### åº”ç”¨åœºæ™¯

å‡è®¾å°èœç»´æŠ¤ä¸€ä¸ªåœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿è¡Œçš„WebæœåŠ¡ï¼Œè¯¥æœåŠ¡æ­£å¸¸æƒ…å†µä¸‹ä»…è®°å½• `INFO` çº§åˆ«ä»¥ä¸Šçš„æ—¥å¿—ã€‚ä½†æ˜¯ï¼Œå½“é‡åˆ°æŸäº›ç‰¹å®šé—®é¢˜æ—¶ï¼Œå°èœå¯èƒ½éœ€è¦ä¸´æ—¶å¢åŠ æ—¥å¿—çš„è¯¦ç»†ç¨‹åº¦ï¼Œä»¥ä¾¿èƒ½æ›´å¥½åœ°åˆ†æå’Œè°ƒè¯•é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œå°èœå¯èƒ½æƒ³è¦å°†æŸä¸ªæ¨¡å—çš„æ—¥å¿—çº§åˆ«ä» `INFO` æå‡åˆ° `DEBUG` æ¥è·å¾—æ›´å¤šä¿¡æ¯ã€‚

###### ç¤ºä¾‹ä»£ç 

>  
 åœ¨ä¸é‡å†™æ•´ä¸ªæ—¥å¿—é…ç½®çš„æƒ…å†µä¸‹åŠ¨æ€è°ƒæ•´æ—¥å¿—é…ç½®ï¼Œä»…æ›´æ–°äº†æ—¥å¿—çº§åˆ«ã€‚è¿™å¯¹äºç”Ÿäº§ç¯å¢ƒä¸­çš„é—®é¢˜è¯Šæ–­å’Œè°ƒè¯•ä¼šæœ‰ç”¨ã€‚ 

1. **åˆå§‹æ—¥å¿—é…ç½®**ï¼šæœ€åˆï¼Œå°èœçš„æ—¥å¿—é…ç½®è®¾ç½®ä¸ºä»…è®°å½• `INFO` çº§åˆ«åŠä»¥ä¸Šçš„æ—¥å¿—ã€‚1. **æ£€æµ‹åˆ°ç‰¹å®šé—®é¢˜**ï¼šå½“ç³»ç»Ÿæ£€æµ‹åˆ°ç‰¹å®šé—®é¢˜ï¼ˆå¯èƒ½æ˜¯é€šè¿‡é”™è¯¯è®¡æ•°ã€ç‰¹å®šç±»å‹çš„è¯·æ±‚æˆ–å…¶ä»–æŒ‡æ ‡ï¼‰æ—¶ï¼Œå°èœæƒ³åŠ¨æ€è°ƒæ•´ç›¸å…³æ¨¡å—çš„æ—¥å¿—çº§åˆ«ä»¥æ•è·æ›´è¯¦ç»†çš„ä¿¡æ¯ã€‚1. **åº”ç”¨å¢é‡æ›´æ–°**ï¼šæ­¤æ—¶ï¼Œå°èœå¯ä»¥ä½¿ç”¨ `incremental=True` æ¥æ›´æ–°ç‰¹å®šæ—¥å¿—è®°å½•å™¨çš„é…ç½®ï¼Œè€Œä¸å½±å“å…¶ä»–é…ç½®ã€‚
```
import logging
from logging.config import dictConfig
import time

# åˆå§‹é…ç½®ï¼Œè®°å½• INFO çº§åˆ«åŠä»¥ä¸Šçš„æ—¥å¿—
initial_config = {<!-- -->
    'version': 1,
    'handlers': {<!-- -->
        'console': {<!-- -->
            'class': 'logging.StreamHandler',
            'level': 'DEBUG'
        }
    },
    'root': {<!-- -->
        'level': 'INFO',
        'handlers': ['console'],
    }
}
dictConfig(initial_config)

logger = logging.getLogger()

# æ¨¡æ‹Ÿåº”ç”¨ç¨‹åºè¿è¡Œ
for i in range(5):
    if i == 3:
        # å½“å‡ºç°ç‰¹å®šæ¡ä»¶æ—¶ï¼Œæå‡æ—¥å¿—çº§åˆ«åˆ° DEBUG
        incremental_config = {<!-- -->
            'version': 1,
            'incremental': True,
            'root': {<!-- -->
                'level': 'DEBUG'
            }
        }
        dictConfig(incremental_config)
        logger.debug("æ—¥å¿—çº§åˆ«å·²æå‡è‡³ DEBUG")

    logger.debug(f"è¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯ {<!-- -->i}")
    logger.info(f"ä¸€èˆ¬çš„ä¿¡æ¯ {<!-- -->i}")
    time.sleep(1)


```

##### 8. disable_existing_loggers

>  
 æ˜¯å¦è¦ç¦ç”¨ä»»ä½•ç°æœ‰çš„éæ ¹æ—¥å¿—è®°å½•å™¨ã€‚å½¢å‚é»˜è®¤ä¸º `True`ã€‚è¿™ä¸ªé€‰é¡¹çš„ä½œç”¨ä¸»è¦æ˜¯æ§åˆ¶æ–°çš„æ—¥å¿—é…ç½®æ˜¯å¦ä¼šå½±å“åˆ°ç°æœ‰çš„æ—¥å¿—è®°å½•å™¨ã€‚ 

- å½“ `disable_existing_loggers` è®¾ç½®ä¸º `True` æ—¶ï¼Œå®ƒçš„ä½œç”¨æ˜¯å…³é—­ï¼ˆç¦ç”¨ï¼‰ä¹‹å‰åˆ›å»ºçš„æ‰€æœ‰æ—¥å¿—è®°å½•å™¨ï¼Œé™¤éå®ƒä»¬åœ¨æ–°çš„æ—¥å¿—é…ç½®ä¸­æ˜ç¡®å®šä¹‰ã€‚- å½“ `disable_existing_loggers` è®¾ç½®ä¸º `False` æ—¶ï¼Œå®ƒçš„ä½œç”¨æ˜¯å¿½ç•¥ä¹‹å‰åˆ›å»ºçš„æ—¥å¿—è®°å½•å™¨ï¼Œä¸ä¼šå…³é—­å®ƒä»¬ï¼Œé™¤éåœ¨æ–°çš„æ—¥å¿—é…ç½®ä¸­æ˜ç¡®å®šä¹‰ã€‚
å¦‚æœå¸Œæœ›ä¿ç•™ç°æœ‰è®°å½•å™¨çš„é…ç½®ï¼Œå¹¶ä¸”ä¸å¸Œæœ›æ–°çš„é…ç½®è¦†ç›–å®ƒä»¬ï¼Œé€šå¸¸ä¼šå°† `disable_existing_loggers` è®¾ç½®ä¸º `False`ã€‚

å¦‚æœæƒ³è¦åœ¨æ–°çš„é…ç½®ä¸­é‡æ–°å®šä¹‰æ‰€æœ‰è®°å½•å™¨çš„é…ç½®ï¼Œåˆ™ä¸å¿…ç†ä¼šï¼Œå› ä¸º `disable_existing_loggers` é»˜è®¤ä¸º `True`ã€‚

```
log_config = {<!-- -->
    'version': 1,
    'disable_existing_loggers': False
}

```

#### ğŸ§ä½¿ç”¨JSON

**log_config.json**

```
{<!-- -->
    "version": 1,
    "formatters": {<!-- -->
        "simple": {<!-- -->
            "format": "%(asctime)s - %(levelname)s - %(name)s - %(message)s"
        }
    },
    "handlers": {<!-- -->
        "console": {<!-- -->
            "class": "logging.StreamHandler",
            "formatter": "simple",
            "level": "DEBUG"
        }
    },
    "root": {<!-- -->
        "level": "INFO",
        "handlers": ["console"]
    }
}

```

**ä»£ç **

```
import logging
import logging.config
import json

# ä» JSON æ–‡ä»¶åŠ è½½é…ç½®
with open('log_config.json', 'r') as file:
    config = json.load(file)
    logging.config.dictConfig(config)

# è·å–æ—¥å¿—è®°å½•å™¨
logger = logging.getLogger()

```

#### ğŸˆä½¿ç”¨YAML

>  
 æ•´ä½“æ¥çœ‹ï¼Œç¡®å®éœ€è¦æ¯” `YAML` ç¡®å®ä¼šæ¯” `JSON` æ›´åŠ ç®€å•å’Œå®¹æ˜“é˜…è¯»ã€‚ 


é…ç½®ä¸ä¸Šé¢çš„ **ä½¿ç”¨ JSON** åŒæ¬¾ã€‚

**log_config.yaml**

```
version: 1	# å¦‚éœ€è¦åˆ™æ·»åŠ æ³¨é‡Š
formatters:
  simple:
    format: "%(asctime)s - %(levelname)s - %(name)s - %(message)s"
handlers:
  console:
    class: logging.StreamHandler
    formatter: simple
    level: DEBUG
root:
  level: INFO
  handlers: [console]

```

é¦–å…ˆéœ€è¦å®‰è£… `PyYAML`

```
pip install pyyaml

```

**ä»£ç **

```
import logging
import logging.config
import yaml

# ä» YAML æ–‡ä»¶åŠ è½½é…ç½®
with open('log_config.yaml', 'r') as file:
    config = yaml.safe_load(file)
    logging.config.dictConfig(config)

# è·å–æ—¥å¿—è®°å½•å™¨
logger = logging.getLogger()

```

### logging.config.fileConfig

>  
 é…ç½®æ–‡ä»¶ï¼Œæ”¯æŒ`INI` æ–‡ä»¶ 


âš ï¸âš ï¸âš ï¸**ä¸æ”¯æŒè¿‡æ»¤å™¨**

âš ï¸âš ï¸âš ï¸**ä¸æ”¯æŒè¿‡æ»¤å™¨**

âš ï¸âš ï¸âš ï¸**ä¸æ”¯æŒè¿‡æ»¤å™¨**

**æ–¹æ³•ï¼š**

```
logging.config.fileConfig(fname, defaults=None, disable_existing_loggers=True, encoding=None)

```

è¿™é‡ŒåªåšåŸºæœ¬ä»‹ç»ï¼Œä¸æ·±å…¥ã€‚å› ä¸ºå®ƒä¸å¤Ÿå‹å¥½ã€‚

#### å‚æ•°è¯¦è§£

ä»¥ä¸‹æ˜¯ `logging.config.fileConfig` å‡½æ•°çš„å‚æ•°æ•´ç†ï¼š

|å‚æ•°åç§°|ç±»å‹|å¿…éœ€|æè¿°
|------
|`fname`|str|å¿…é¡»|é…ç½®æ–‡ä»¶çš„è·¯å¾„ã€‚è¿™ä¸ªæ–‡ä»¶åŒ…å«äº†æ—¥å¿—é…ç½®çš„ä¿¡æ¯ã€‚
|`defaults`|dict|å¯é€‰|é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨çš„å˜é‡çš„é»˜è®¤å€¼ã€‚
|`disable_existing_loggers`|bool|å¯é€‰|å†³å®šæ˜¯å¦ç¦ç”¨åœ¨è°ƒç”¨ `fileConfig` ä¹‹å‰å·²ç»å­˜åœ¨çš„æ—¥å¿—è®°å½•å™¨ã€‚é»˜è®¤ä¸º `True`ã€‚
|`encoding`|str|å¯é€‰|ç”¨äºæŒ‡å®šé…ç½®æ–‡ä»¶çš„ç¼–ç æ–¹å¼ã€‚

#### å¿…éœ€çš„å­—æ®µ

åœ¨ `logging.config.fileConfig` ä¸­ä½¿ç”¨çš„ `INI` æ–‡ä»¶ä¸­ï¼Œæœ‰å‡ ä¸ªå¿…éœ€çš„å­—æ®µæ¥ç¡®ä¿è‡³å°‘åŸºæœ¬çš„æ—¥å¿—é…ç½®èƒ½å¤Ÿå·¥ä½œã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„ç¤ºä¾‹ï¼Œå…¶ä¸­åŒ…å«äº†å¿…éœ€çš„åŸºç¡€å­—æ®µã€‚
- `[loggers]`ï¼šè‡³å°‘éœ€è¦åˆ—å‡ºéœ€è¦é…ç½®çš„æ—¥å¿—è®°å½•å™¨ã€‚- `[handlers]`ï¼šè‡³å°‘éœ€è¦å®šä¹‰ä¸€ä¸ªå¤„ç†å™¨ã€‚- `[formatters]`ï¼šè‡³å°‘éœ€è¦å®šä¹‰ä¸€ä¸ªæ ¼å¼å™¨ã€‚- `[logger_&lt;logger_name&gt;]`ï¼šä¸ºæ¯ä¸ªéœ€è¦é…ç½®çš„è®°å½•å™¨å®šä¹‰å…·ä½“é…ç½®ã€‚- `[handler_&lt;handler_name&gt;]`ï¼šä¸ºæ¯ä¸ªå¤„ç†å™¨å®šä¹‰å…·ä½“é…ç½®ã€‚- `[formatter_&lt;formatter_name&gt;]`ï¼šä¸ºæ¯ä¸ªæ ¼å¼å™¨å®šä¹‰å…·ä½“é…ç½®ã€‚
#### åŸºç¡€ç¤ºä¾‹ INI æ–‡ä»¶

**log_config.ini**
- è¿™ä¸ªé…ç½®å®šä¹‰äº†ä¸€ä¸ªæ ¹æ—¥å¿—è®°å½•å™¨ `root`ï¼Œå®ƒçš„æ—¥å¿—çº§åˆ«ä¸º `INFO`ã€‚- æœ‰ä¸€ä¸ªå¤„ç†å™¨ `consoleHandler`ï¼Œå®ƒå°†æ—¥å¿—è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºï¼ˆæ§åˆ¶å°ï¼‰ï¼ŒåŒæ—¶ä¹Ÿè®¾ç½®ä¸º `INFO` çº§åˆ«ã€‚- æœ‰ä¸€ä¸ªæ ¼å¼å™¨ `simpleFormatter`ï¼Œå®ƒå®šä¹‰äº†æ—¥å¿—çš„æ˜¾ç¤ºæ ¼å¼ã€‚
```
[loggers]
keys=root

[handlers]
keys=consoleHandler

[formatters]
keys=simpleFormatter

[logger_root]
level=INFO
handlers=consoleHandler

[handler_consoleHandler]
class=StreamHandler
level=INFO
formatter=simpleFormatter
args=(sys.stdout,)

[formatter_simpleFormatter]
format=%(asctime)s - %(levelname)s - %(message)s
datefmt=%Y-%m-%d %H:%M:%S

```

#### ç¤ºä¾‹ä»£ç 

ä»£ç é€šè¿‡ `fileConfig` åŠ è½½ INI æ–‡ä»¶ä¸­çš„é…ç½®ï¼Œç„¶åä½¿ç”¨ `getLogger` åˆ›å»ºä¸€ä¸ªæ—¥å¿—è®°å½•å™¨ã€‚æ­¤è®°å½•å™¨å°†æ ¹æ® `INI` æ–‡ä»¶ä¸­å®šä¹‰çš„é…ç½®å¤„ç†æ—¥å¿—æ¶ˆæ¯ã€‚

```
import logging
import logging.config

logging.config.fileConfig('log_config.ini')

# åˆ›å»ºæ—¥å¿—è®°å½•å™¨
logger = logging.getLogger()

# è®°å½•æ¶ˆæ¯
logger.info("è¿™æ˜¯ä¸€ä¸ªä¿¡æ¯çº§åˆ«çš„æ—¥å¿—")
logger.debug("è¿™æ¡è°ƒè¯•æ¶ˆæ¯ä¸ä¼šæ˜¾ç¤ºï¼Œå› ä¸ºæ—¥å¿—çº§åˆ«è®¾ç½®ä¸º INFO")


```

#### ç‰¹åˆ«å¤„ç†ï¼šæ·»åŠ filters

```
import logging
import logging.config


# è‡ªå®šä¹‰è¿‡æ»¤å™¨
class CommonFilter(logging.Filter):
    def filter(self, record):
        # è¿‡æ»¤æ‰åŒ…å«æ•æ„Ÿä¿¡æ¯çš„æ—¥å¿—
        return "æ•æ„Ÿä¿¡æ¯" not in record.getMessage()
    

logging.config.fileConfig('log_config.ini')

# åˆ›å»ºæ—¥å¿—è®°å½•å™¨
logger = logging.getLogger()
# æ·»åŠ è¿‡æ»¤å™¨
logger.addFilter(CommonFilter())

# è®°å½•æ¶ˆæ¯
logger.info("è¿™æ˜¯ä¸€ä¸ªä¿¡æ¯çº§åˆ«çš„æ—¥å¿—")
logger.debug("è¿™æ¡è°ƒè¯•æ¶ˆæ¯ä¸ä¼šæ˜¾ç¤ºï¼Œå› ä¸ºæ—¥å¿—çº§åˆ«è®¾ç½®ä¸º INFO")

```

## å®é™…æ¡ˆä¾‹

ä»¥ä¸‹çš„ä»£ç æ¥è‡ª
- 
é‡Œçš„ **ç¤ºä¾‹ä»£ç **ï¼Œå°†ä»–ä¿®æ”¹æˆæœ¬æ–‡æ‰€ä»‹ç»çš„ **logging.config é«˜çº§é…ç½®**ã€‚

```
import logging
import logging.config
import requests
import sys


class RemoteLogHandler(logging.Handler):
    """è‡ªå®šä¹‰è¿œç¨‹å¤„ç†å™¨"""

    def __init__(self, remote_url):
        super().__init__()
        self.remote_url = remote_url
        self.error_logger = logging.getLogger('error')
        # self.setFormatter(formatter)

    def emit(self, record):
        # å‘é€æ—¥å¿—è®°å½•åˆ°è¿œç¨‹æœåŠ¡å™¨
        log_entry = self.format(record)  # æ ¼å¼åŒ–æ—¥å¿—è®°å½•
        try:
            response = requests.post(self.remote_url, data=log_entry)
            response.raise_for_status()
        except Exception as e:
            record.msg = f"Original message: {<!-- -->record.msg}, Failed to send log to remote: {<!-- -->str(e)}"
            print('error_logger ç­‰çº§æ˜¯ ', self.error_logger.level)
            self.error_logger.handle(record)


log_config = {<!-- -->
    'version': 1,
    'formatters': {<!-- -->
        'simple': {<!-- -->
            'format': '%(levelname)-7s - %(asctime)s - %(name)s - %(message)s'
        }
    },
    'handlers': {<!-- -->
        'file_global': {<!-- -->
            '()': 'logging.FileHandler',
            'filename': 'ecommerce_global.log',
            'level': 'DEBUG',
            'formatter': 'simple',
            'delay': True
        },
        'file_error': {<!-- -->
            '()': 'logging.FileHandler',
            'filename': 'error.log',
            'level': 'ERROR',
            'formatter': 'simple',
            'delay': True
        },
        'file_order': {<!-- -->
            '()': 'logging.FileHandler',
            'filename': 'orders.log',
            'level': 'WARNING',
            'formatter': 'simple',
            'delay': True
        },
        'file_payment': {<!-- -->
            '()': 'logging.FileHandler',
            'filename': 'payments.log',
            'level': 'ERROR',
            'formatter': 'simple',
            'delay': True
        },
        'stream': {<!-- -->
            '()': 'logging.StreamHandler',
            'stream': 'ext://sys.stdout',
            'formatter': 'simple'
        },
        'remote': {<!-- -->
            '()': '__main__.RemoteLogHandler',
            'remote_url': 'http://127.0.0.1:5000/submit_log',
        }
    },
    'loggers': {<!-- -->
        'ecommerce': {<!-- -->
            'handlers': ['file_global', 'stream'],
            'level': 'DEBUG'
        },
        'ecommerce.orders': {<!-- -->
            'handlers': ['file_order', 'remote'],
            'level': 'INFO',
            'propagate': False
        },
        'ecommerce.payments': {<!-- -->
            'handlers': ['file_payment', 'remote'],
            'level': 'WARNING',
            'propagate': False
        },
        'error': {<!-- -->
            'handlers': ['file_error'],
            'level': 'WARNING',
        }
    }
}

if __name__ == '__main__':
    logging.config.dictConfig(log_config)

    # ä½¿ç”¨æ—¥å¿—è®°å½•å™¨
    global_logger = logging.getLogger('ecommerce')
    order_logger = logging.getLogger('ecommerce.orders')
    payment_logger = logging.getLogger('ecommerce.payments')
    # æ—¥å¿—æµ‹è¯•
    global_logger.info('Global logger configured')
    order_logger.warning('Order logger configured')
    payment_logger.error('Payment logger configured')


```

## æ€»ç»“ğŸˆğŸˆ

æœ¬æ–‡å…¨é¢ä»‹ç»äº†`Python` ä¸­`logging`æ¨¡å—çš„é«˜çº§æ–‡ä»¶é…ç½®æŠ€å·§ï¼Œé‡ç‚¹è®¨è®ºäº†`dictConfig`å’Œ`fileConfig`ä¸¤ç§é…ç½®æ–¹æ³•ã€‚

é€šè¿‡`dictConfig`ï¼Œå¼€å‘è€…å¯ä»¥çµæ´»åœ°ä½¿ç”¨å­—å…¸ã€`JSON` æˆ– `YAML` æ ¼å¼æ¥è®¾ç½®æ—¥å¿—çº§åˆ«ã€æ ¼å¼å’Œå¤„ç†å™¨ï¼Œ

è€Œ`fileConfig`åˆ™æä¾›äº†å¯¹INIæ ¼å¼é…ç½®æ–‡ä»¶çš„æ”¯æŒã€‚å°½ç®¡`fileConfig`åœ¨åŠŸèƒ½ä¸Šæœ‰æ‰€é™åˆ¶ï¼Œä½†å®ƒä»é€‚ç”¨äºç®€å•çš„é…ç½®éœ€æ±‚ã€‚

æ–‡ç« é€šè¿‡å®ä¾‹å’Œæ³¨æ„äº‹é¡¹ï¼ŒæŒ‡å¯¼è¯»è€…å¦‚ä½•é€‰æ‹©å’Œåº”ç”¨è¿™äº›é…ç½®æ–¹æ³•ï¼Œä»¥ä¼˜åŒ–æ—¥å¿—å¤„ç†æµç¨‹å¹¶æå‡åº”ç”¨æ€§èƒ½ã€‚

æ€»çš„æ¥è¯´ï¼Œè¿™ç¯‡æ–‡ç« å¯ä»¥å¸®åŠ©è¯»è€…æœ‹å‹ä»¬æ·±å…¥äº†è§£å¦‚ä½•ä½¿ç”¨ `logging.config` è¿›è¡Œæ—¥å¿—æ–‡ä»¶é…ç½®ã€‚è¿›è€Œå¸®åŠ©è¯»è€…å»ºç«‹ä¸€ä¸ªé«˜æ•ˆã€å¯ç»´æŠ¤çš„æ—¥å¿—ç³»ç»Ÿã€‚

## åè¯

æœ¬æ¬¡åˆ†äº«åˆ°æ­¤ç»“æŸï¼Œ

see you~~âœ¨âœ¨
